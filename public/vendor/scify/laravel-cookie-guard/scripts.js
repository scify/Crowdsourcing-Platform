document.addEventListener("DOMContentLoaded",function(){g(),k(),E()});function g(){document.querySelectorAll(".accordion-button").forEach(e=>{e.removeEventListener("click",r)}),document.querySelectorAll(".accordion-button").forEach(e=>{e.addEventListener("click",r)})}function r(e){e.stopPropagation();const o=e.currentTarget;y(o)}function y(e){const o=document.querySelector(e.dataset.target);document.querySelectorAll(".accordion-collapse").forEach(t=>{if(t!==o){t.classList.remove("show");const n=document.querySelector(`[data-target="#${t.id}"]`);n&&(n.classList.add("collapsed"),window.cookies_consent_translations&&(n.textContent=window.cookies_consent_translations.read_more))}}),o.classList.contains("show")?(o.classList.remove("show"),e.classList.add("collapsed"),window.cookies_consent_translations&&(e.textContent=window.cookies_consent_translations.read_more)):(o.classList.add("show"),e.classList.remove("collapsed"),window.cookies_consent_translations&&(e.textContent=window.cookies_consent_translations.read_less))}function k(){const e=document.getElementById("scify-cookies-consent"),o=document.getElementById("scify-cookie-consent-floating-button"),t=e.dataset.showFloatingButton==="true"||e.dataset.showFloatingButton==="1",n=e.dataset.hideFloatingButtonOnMobile==="true"||e.dataset.hideFloatingButtonOnMobile==="1",s=e.dataset.cookiePrefix;let i=b(s+"cookies_consent");h(e,o,t,n,i),f(i),m({"customise-cookies":w,"accept-all-cookies":B,"accept-selected-cookies":u,"reject-optional-cookies":C,"close-cookie-policy-page":u})}function m(e){for(const[o,t]of Object.entries(e)){const n=document.getElementById(o);n&&n.addEventListener("click",t)}}function h(e,o,t,n,s){a()?e.style.display="block":p(e,o,t,n,s)}function p(e,o,t,n,s){const i=e.dataset.useShowModal==="true"||e.dataset.useShowModal==="1";if(s)e.style.display="none",t&&o&&(o.style.display=n&&window.innerWidth<768?"none":"block");else{e.style.display="block";const c=e.querySelector("dialog");c&&i&&c.showModal()}}function f(e){if(e){const o=JSON.parse(e);for(const t in o){const n=document.getElementById(t);n&&(n.checked=o[t])}}}function w(){document.getElementById("cookie-categories-container").classList.remove("display-none"),document.getElementById("customise-cookies").closest(".button-col").classList.add("display-none"),document.getElementById("accept-selected-cookies").closest(".button-col").classList.remove("display-none")}function B(){d(l(!0))}function u(){d(l())}function C(){d(l(!1,"strictly_necessary"))}function l(e=!1,o=null){const t={};return document.querySelectorAll(".cookie-category").forEach(n=>{t[n.id]=e||n.id===o||n.checked}),t}function d(e){const o=document.getElementById("scify-cookies-consent"),t=document.getElementById("scify-cookie-consent-floating-button"),n=o.dataset.showFloatingButton==="true"||o.dataset.showFloatingButton==="1",s=o.dataset.cookiePrefix;e.locale=o.dataset.locale,a()||(o.style.display="none",n&&(t.style.display="block")),fetch(o.dataset.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(e)}).then(i=>i.json()).then(i=>{if(i.success){L(s+"cookies_consent",JSON.stringify(e),30),f(JSON.stringify(e)),S(i.message);const c=o.querySelector("dialog");c&&c.close(),a()&&history.back()}}).catch(()=>{console.error("Error storing cookie consent");const i=o.querySelector("dialog");i&&i.close()})}function S(e){const o=document.getElementById("scify-cookies-consent-wrapper");if(o){const t=document.createElement("div");t.classList.add("cookie-success-message"),t.innerText=e,o.appendChild(t),setTimeout(()=>{t.classList.add("show")},100),setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>{t.remove()},1e3)},4e3)}}function E(){const e=document.getElementById("cookie-policy-link");e&&e.addEventListener("click",function(){_("cookieConsent")})}function a(){const e=document.getElementById("scify-cookies-consent");return e.dataset.onCookiesPage==="true"||e.dataset.onCookiesPage==="1"}function L(e,o,t){let n="";{const s=new Date;s.setTime(s.getTime()+t*24*60*60*1e3),n="; expires="+s.toUTCString()}document.cookie=e+"="+(o||"")+n+"; path=/"}function b(e){const o=e+"=",t=document.cookie.split(";");for(const n of t){let s=n.trim();if(s.startsWith(o))return s.substring(o.length,s.length)}return null}function _(e){document.cookie=e+"=; Max-Age=-99999999;"}window.toggleCookieBanner=function(){if(a())return;const e=document.getElementById("scify-cookies-consent"),o=document.getElementById("scify-cookie-consent-floating-button"),t=e.dataset.showFloatingButton==="true"||e.dataset.showFloatingButton==="1",n=e.dataset.useShowModal==="true"||e.dataset.useShowModal==="1",s=e.querySelector("dialog");e.style.display==="none"||e.style.display===""?(e.style.display="block",s&&n&&s.showModal(),t&&(o.style.display="none")):(e.style.display="none",s&&n&&s.close(),t&&(o.style.display="block"))};
